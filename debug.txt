Testing multi_query_cached_kv_attention with dtype=torch.float32, block_size=8, head_size=32
single: tensor([[[ 1.0373e-04, -1.6337e-04,  1.7915e-04, -9.7989e-05, -2.3725e-04,
          -4.5445e-05, -2.9753e-04, -1.4588e-04, -2.8320e-04, -3.8255e-05,
          -2.9617e-04, -1.5722e-04, -2.3184e-04,  1.1541e-07,  1.5178e-04,
          -1.4206e-04,  3.8836e-05, -3.7274e-06, -9.6926e-05,  2.3792e-04,
           1.4310e-04, -1.5208e-04, -1.2213e-04,  2.0236e-04, -2.9389e-05,
          -1.0318e-04,  3.5140e-04,  1.9803e-04,  2.6466e-05,  2.3456e-04,
           4.0549e-05, -1.4475e-04]],

        [[ 1.0778e-04, -2.6096e-04,  8.7374e-05, -1.8266e-04, -9.0072e-05,
           4.2566e-05, -2.9039e-04, -1.9339e-04, -2.7921e-04, -4.4294e-05,
          -2.7876e-04, -1.3312e-04, -9.9346e-05,  7.8427e-05,  5.7451e-05,
          -1.2945e-05, -7.2034e-05,  1.4011e-05, -1.5988e-04,  1.7881e-04,
           7.4018e-05, -9.9361e-05, -8.8567e-05,  2.3372e-04, -8.7858e-05,
          -1.2172e-04,  3.5158e-04,  1.4115e-04,  5.3310e-05,  1.4833e-04,
           6.8509e-05, -1.0678e-04]]], device='cuda:0')
mul: tensor([[[ 1.0373e-04, -1.6337e-04,  1.7915e-04, -9.7989e-05, -2.3725e-04,
          -4.5445e-05, -2.9753e-04, -1.4588e-04, -2.8320e-04, -3.8255e-05,
          -2.9617e-04, -1.5722e-04, -2.3184e-04,  1.1541e-07,  1.5178e-04,
          -1.4206e-04,  3.8836e-05, -3.7274e-06, -9.6926e-05,  2.3792e-04,
           1.4310e-04, -1.5208e-04, -1.2213e-04,  2.0236e-04, -2.9389e-05,
          -1.0318e-04,  3.5140e-04,  1.9803e-04,  2.6466e-05,  2.3456e-04,
           4.0549e-05, -1.4475e-04]],

        [[ 1.0778e-04, -2.6096e-04,  8.7374e-05, -1.8266e-04, -9.0072e-05,
           4.2566e-05, -2.9039e-04, -1.9339e-04, -2.7921e-04, -4.4294e-05,
          -2.7876e-04, -1.3312e-04, -9.9346e-05,  7.8427e-05,  5.7451e-05,
          -1.2945e-05, -7.2034e-05,  1.4011e-05, -1.5988e-04,  1.7881e-04,
           7.4018e-05, -9.9361e-05, -8.8567e-05,  2.3372e-04, -8.7858e-05,
          -1.2172e-04,  3.5158e-04,  1.4115e-04,  5.3310e-05,  1.4833e-04,
           6.8509e-05, -1.0678e-04]]], device='cuda:0')
ref: tensor([[[ 1.0373e-04, -1.6337e-04,  1.7915e-04, -9.7989e-05, -2.3725e-04,
          -4.5445e-05, -2.9753e-04, -1.4588e-04, -2.8320e-04, -3.8255e-05,
          -2.9617e-04, -1.5722e-04, -2.3184e-04,  1.1542e-07,  1.5178e-04,
          -1.4206e-04,  3.8836e-05, -3.7274e-06, -9.6926e-05,  2.3792e-04,
           1.4310e-04, -1.5208e-04, -1.2213e-04,  2.0236e-04, -2.9389e-05,
          -1.0318e-04,  3.5140e-04,  1.9803e-04,  2.6466e-05,  2.3456e-04,
           4.0549e-05, -1.4475e-04]],

        [[ 1.0778e-04, -2.6096e-04,  8.7374e-05, -1.8266e-04, -9.0072e-05,
           4.2566e-05, -2.9039e-04, -1.9339e-04, -2.7921e-04, -4.4294e-05,
          -2.7876e-04, -1.3312e-04, -9.9346e-05,  7.8427e-05,  5.7451e-05,
          -1.2945e-05, -7.2034e-05,  1.4011e-05, -1.5988e-04,  1.7881e-04,
           7.4018e-05, -9.9361e-05, -8.8567e-05,  2.3372e-04, -8.7858e-05,
          -1.2172e-04,  3.5158e-04,  1.4115e-04,  5.3310e-05,  1.4833e-04,
           6.8508e-05, -1.0678e-04]]], device='cuda:0')
